<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de Payback do Imóvel</title>
  <style>
    :root{
      --bg:#0b1320; --card:#121b2c; --ink:#e8eefc; --muted:#a9b4c7; --accent:#5fb3ff; --bad:#ff6666;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,sans-serif;background:radial-gradient(1200px 800px at 20% -10%,#16233b 0,#0b1320 60%),var(--bg);color:var(--ink);}
    .wrap{max-width:720px;margin:40px auto;padding:24px}
    header{display:flex;align-items:center;gap:12px;margin-bottom:16px}
    h1{font-size:clamp(20px,2.6vw,28px);line-height:1.2;margin:0}
    p.lead{color:var(--muted);margin:.25rem 0 1rem}
    .card{background:var(--card);border:1px solid rgba(255,255,255,.06);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.25);padding:18px}
    form{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .full{grid-column:1/-1}
    label{display:block;font-size:.85rem;color:var(--muted);margin:2px 0 6px}
    input{width:100%;padding:12px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.08);background:#0f1726;color:var(--ink);font-size:1rem}
    input:focus{outline:2px solid var(--accent);border-color:transparent}
    .actions{display:flex;gap:10px;flex-wrap:wrap}
    button{appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:600;cursor:pointer}
    .primary{background:var(--accent)}
    .ghost{background:transparent;border:1px solid rgba(255,255,255,.18);color:var(--ink)}
    .out{margin-top:14px;display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .kpi{background:#0f1726;border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:14px}
    .kpi h3{margin:0 0 8px;font-size:.95rem;color:var(--muted)}
    .kpi .big{font-size:1.6rem;font-variant-numeric:tabular-nums;letter-spacing:.3px}
    .kpi small{display:block;color:var(--muted)}
    .warn{color:var(--bad);font-weight:600}
    footer{margin-top:18px;color:var(--muted);font-size:.85rem}
    .note{font-size:.82rem;color:var(--muted)}
    @media (max-width:680px){form{grid-template-columns:1fr}.out{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3 11.5V19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7.5" stroke="white" opacity=".7" stroke-width="1.5"/><path d="M12 3l8 6H4l8-6Z" stroke="white" opacity=".7" stroke-width="1.5"/></svg>
      <h1>Calculadora de Payback do Imóvel</h1>
    </header>
    <p class="lead">Extremamente simples: informe os valores e veja em quantos meses (e anos) o aluguel paga o imóvel. Cálculo <em>bruto</em> e <em>líquido</em> (descontando IPTU e condomínio) com taxa de corretagem opcional.</p>

    <div class="card">
      <form id="form">
        <div>
          <label for="valorImovel">Valor do imóvel (R$)</label>
          <input id="valorImovel" inputmode="decimal" placeholder="Ex.: 450.000,00" required />
        </div>
        <div>
          <label for="aluguel">Aluguel mensal (R$)</label>
          <input id="aluguel" inputmode="decimal" placeholder="Ex.: 2.800,00" required />
        </div>
        <div>
          <label for="iptu">IPTU mensal (R$)</label>
          <input id="iptu" inputmode="decimal" placeholder="Ex.: 250,00" />
        </div>
        <div>
          <label for="condominio">Condomínio mensal (R$)</label>
          <input id="condominio" inputmode="decimal" placeholder="Ex.: 650,00" />
        </div>
        <div class="full">
          <label for="corretagem">Taxa de corretagem (R$) — opcional</label>
          <input id="corretagem" inputmode="decimal" placeholder="Ex.: 5.000,00" />
        </div>
        <div class="actions full">
          <button type="submit" class="primary">Calcular</button>
          <button type="button" class="ghost" id="limpar">Limpar</button>
        </div>
      </form>

      <div class="out" id="saida" hidden>
        <div class="kpi">
          <h3>Payback bruto</h3>
          <div class="big" id="mesesBrutos">—</div>
          <small id="anosBrutos">—</small>
        </div>
        <div class="kpi">
          <h3>Payback líquido</h3>
          <div class="big" id="mesesLiquidos">—</div>
          <small id="anosLiquidos">—</small>
        </div>
        <div class="full note" id="aviso"></div>
      </div>
    </div>

    <footer>
      <div class="note">Fórmulas: <code>meses_brutos = valor_imovel / aluguel</code>; <code>meses_liquidos = (valor_imovel + corretagem) / (aluguel − iptu − condominio)</code>.</div>
    </footer>
  </div>

  <script>
    const brToNumber = (s)=>{
      if(!s) return 0;
      // aceita "1.234,56" ou "1234.56" ou "1234,56"
      s = String(s).trim().replace(/\s+/g,'');
      // se tem vírgula como decimal, remove pontos e troca vírgula por ponto
      if(/,\d{1,2}$/.test(s)){ s = s.replace(/\./g,'').replace(',', '.'); }
      return Number(s.replace(/[^0-9.\-]/g,'')) || 0;
    };

    const formatNum = (n)=> new Intl.NumberFormat('pt-BR', { maximumFractionDigits: 2 }).format(n);

    const form = document.getElementById('form');
    const saida = document.getElementById('saida');
    const mesesBrutos = document.getElementById('mesesBrutos');
    const anosBrutos = document.getElementById('anosBrutos');
    const mesesLiquidos = document.getElementById('mesesLiquidos');
    const anosLiquidos = document.getElementById('anosLiquidos');
    const aviso = document.getElementById('aviso');

    const $ = (id)=> document.getElementById(id);

    function calcular(e){
      e && e.preventDefault();
      const a = brToNumber($("valorImovel").value);
      const b = brToNumber($("aluguel").value);
      const d = brToNumber($("iptu").value);
      const f = brToNumber($("condominio").value);
      const eTax = brToNumber($("corretagem").value);

      if(!a || !b){
        saida.hidden = true;
        return;
      }

      const bruto = a / b;
      const denom = b - d - f;
      const liquido = denom > 0 ? (a + eTax) / denom : Infinity;

      mesesBrutos.textContent = isFinite(bruto) ? `${formatNum(bruto)} meses` : '—';
      anosBrutos.textContent = isFinite(bruto) ? `≈ ${formatNum(bruto/12)} anos` : '';

      if(isFinite(liquido)){
        mesesLiquidos.textContent = `${formatNum(liquido)} meses`;
        anosLiquidos.textContent = `≈ ${formatNum(liquido/12)} anos`;
        aviso.innerHTML = '';
      } else {
        mesesLiquidos.textContent = '—';
        anosLiquidos.textContent = '';
        aviso.innerHTML = '<span class="warn">O cálculo líquido não é possível</span>: aluguel − IPTU − condomínio ≤ 0.';
      }

      saida.hidden = false;
    }

    form.addEventListener('submit', calcular);
    ["valorImovel","aluguel","iptu","condominio","corretagem"].forEach(id=>{
      $(id).addEventListener('input', ()=>{ /* cálculo em tempo real opcional */ });
    });
    document.getElementById('limpar').addEventListener('click', ()=>{
      form.reset(); saida.hidden = true; aviso.textContent = '';
    });
  </script>
</body>
</html>
